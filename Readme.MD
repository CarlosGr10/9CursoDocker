# CURSO DE DOCKER üêã

# Virtualizacion
Permite atacar en simult√°neo los tres problemas del desarrollo de software profesional.

## Problemas de la virtualizacion

- PESO: En el orden de los GBs. Repiten archivos en com√∫n. Inicio lento.
- COSTO DE ADMINISTRACION: Necesita mantenimiento igual que cualquier otra computadora.
- MULTIPLES DE FORMATO: VDI, VMDK, VHD, raw, etc

## Containerizaci√≥n

El empleo de contenedores para construir y desplegar software.

Flexibles
Livianos
Portables
Bajo acoplamiento
Escalables
Seguros

## Virtualizacion vs Containerizaci√≥n

Virtualizaci√≥n: A diferencia de un contenedor, las m√°quinas virtuales ejecutan un sistema operativo completo, incluido su propio kernel.
Containerizaci√≥n: Un contenedor es un silo aislado y ligero para ejecutar una aplicaci√≥n en el sistema operativo host. Los contenedores se basan en el kernel del sistema operativo host (que puede considerarse la fontaner√≠a del sistema operativo), y solo puede contener aplicaciones y algunas API ligeras del sistema operativo y servicios que se ejecutan en modo de usuario.

# Qu√© es y c√≥mo funciona Docker

![](https://i.imgur.com/spx30aQ.png)

![](https://i.imgur.com/TRYEMSr.png)

*Componentes DENTRO del circulo de Docker:*

Docker daemon: Es el centro de docker, el coraz√≥n que gracias a el, podemos comunicarnos con los servicios de docker.

REST API: Como cualquier otra API, es la que nos permite visualizar docker de forma ‚Äúgr√°fica‚Äù.

Cliente de docker: Gracias a este componente, podemos comunicarnos con el coraz√≥n de docker (Docker Daemon) que por defecto es la l√≠nea de comandos.
Dentro de la arquitectura de Docker encontramos:

- Contenedores: Es la raz√≥n de ser de Docker, es donde podemos encapsular nuestras imagenes para llevarlas a otra computadora, o servidor, etc.

- Imagenes: Son las encapsulaciones de x contenedor. Podemos correr nuestra aplicaci√≥n en Java por medio de una imagen, podemos utilizar Ubuntu para correr nuestro proyecto, etc.

= Volumenes de datos: Podemos acceder con seguridad al sistema de archivos de nuestra m√°quina.

- Redes: Son las que permiten la comunicaci√≥n entre contenedores.

# Primeros pasos: hola mundo

Nota: Antes de correr nuestro primer contenedor hay que asegurarnos de agregar un usuario para correr sin root

```
$ sudo groupadd docker
$ sudo usermod -aG docker name_user
$ newgrp docker

```

Comando para correr nuestro primer contenedor üòÄ

``` 
    docker run hello-world 
```

# Conceptos fundamentales de Docker: contenedores

Es una agrupaci√≥n de procesos.

Es una entidad l√≥gica, no tiene el limite estricto de las m√°quinas virtuales, emulaci√≥n del sistema operativo simulado por otra m√°s abajo.

Ejecuta sus procesos de forma nativa.

Los procesos que se ejecutan adentro de los contenedores ven su universo como el contenedor lo define, no pueden ver mas all√° del contenedor, a pesar de estar corriendo en una maquina m√°s grande.

No tienen forma de consumir m√°s recursos que los que se les permite. Si esta restringido en memoria ram por ejemplo, es la √∫nica que pueden usar.

A fines pr√°cticos los podemos imaginar c√≥mo maquinas virtuales, pero NO lo son. M√°quinas virtuales livianas.

Docker corre de forma nativa solo en Linux.

Sector del disco: Cuando un contenedor es ejecutado, el daemon de docker le dice, a partir de ac√° para arriba este disco es tuyo, pero no puedes subir mas arriba.

Docker hace que los procesos adentro de un contenedor este aislados del resto del sistema, no le permite ver m√°s all√°.

Cada contenedor tiene un ID √∫nico, tambi√©n tiene un nombre.

# Comprendiendo el estado de Docker

Saber que contenedores estan correindo en el deamon de docker 

```
    docker ps
```

Ver todos los contenedores de docker , nota: cuando realizamos un docker run , estamos creando un nuevo contenedor y lo ejecuta

```
    docker ps -a 
```

Para ver la informaci√≥n de un contenedor 

```
    docker inspect id/nombre
```


ponerle un nombre a un contenedor con la opcion --name
y renombrar un contenedor 

```
    docker run --name hola1 hello-world

    docker rename hola1 nombre_formal
```

Eliminar los contenedores que ya no utilizamos, 
prune nos elimina todos los contenedores que estan parados

```
    docker rm id/nombre_contenedor
    docker container prune
```


# El modo interactivo


```
    docker run ubuntu
    docker run -it ubuntu
```

# Ciclo de vida de un contenedor (segundo plano)

Cuando un proceso falla, el contenedor se detiene

El modo detach , el contenedor corre en segundo plano

```
    docker run --name hey -d ubuntu tail -f /dev/null
```

Entrar al contenedor con el comando exec

```
    docker exec -it id/contenedor shell
```

Dentro del contenedor de docker podemos ejecutar el siguinte comando

```
    ps -aux
```

Otra forma de parar los contenedores 

```
    docker inspect --format '{{.State.Pid}}' id/contenedor
    
    kill numero_pid
```

# Exponiendo contenedores (Puertos)

Para enfocarnos en este ejemplo utilizamos nginx
la bandera -p es de publish, que es la que expone el pueto del contenedor
del lado izquierdo es la de nuetra maquina y el lado derecho es la del contenedor
**-p puertoM√°quna:puertoContenedor**

```
    docker run -d --name proxy -p 8080:80 nginx
```

![](https://i.imgur.com/Xat2Lst.png)

Ver los logs del contenedor

```
    docker logs -f proxy
```


#  Bind mounts

Utilizaremos mongodb 

```
    docker run -d --name db mongo
```

dentro del contenedor utilizamos

```
    $ mongogs
    $ show dbs
    $ use banco
    $ db.users.insert({"nombre":"carlos"})
    $ db.users.find()
```

Cuando salimos del contenedor nos damos cuenta que no guardo informacion
lo que hacemos es montar un bind mount

creamos una carpeta y despues ejecutamos el sig. comando

```
    docker run -d --name db -v /home/garcia/Contenedores/dockerdata/mongodata:/data/db mongo
```

# Vol√∫menes

La diferencia con bind mount es que uno requiere una carpeta fuera del contenedor
y los volumenes son respaldos que maneja docker virtualmente


Listar los volumenes

```
    docker volume ls
```

Crear volumenes

```
    docker volume create nombre_volumen
```

Montar los volumenes

tiene dos parametros mount , 

- src: el el volumen que se le va a montar
- dst: la ruta del contenedor donde se va montar ese volumen 

```
    docker run --name  db -d --mount src=dbdata,dst=/data/db mongo
```

Inspeccionar los volumenes

```
    docker inspect nombre_volumen
```





